# ═══════════════════════════════════════════════════════════════════
# Algo AI Agentic Wallet — Environment Variable Matrix
#
# Local dev:  copy to .env
# Production: set in Railway Dashboard → Variables
#             (Railway injects PORT automatically — do not override)
#
# Developer portal stays on Vercel. Only this Express server moves
# to Railway. Update ai-agentic-wallet.com DNS to Railway's domain
# after first deploy: railway domain → set CNAME in your DNS panel.
# ═══════════════════════════════════════════════════════════════════

# ── Runtime ──────────────────────────────────────────────────────
NODE_ENV=production
PORT=4020

# ── Algorand Node (Nodely Free Tier) ─────────────────────────────
# No API key required. Cloudflare-balanced across 21+ global locations.
# Free tier adds 50ms artificial latency per request.
# Docs: https://nodely.io/docs/free/start/
#
# Mainnet Algod:   https://mainnet-api.4160.nodely.dev
# Mainnet Indexer: https://mainnet-idx.4160.nodely.dev
# Testnet Algod:   https://testnet-api.4160.nodely.dev
# Testnet Indexer: https://testnet-idx.4160.nodely.dev
ALGORAND_NODE_URL=https://mainnet-api.4160.nodely.dev
ALGORAND_INDEXER_URL=https://mainnet-idx.4160.nodely.dev
ALGORAND_NODE_TOKEN=
ALGORAND_NETWORK=mainnet

# ── x402 Protocol ───────────────────────────────────────────────
# Price in micro-USDC (6 decimals). 100000 = $0.10
X402_PRICE_MICROUSDC=100000
# ⚠️  REQUIRED: Paste your Algorand Mainnet treasury wallet address below.
#     This address receives ALL x402 toll payments.
X402_PAY_TO_ADDRESS=<YOUR_MAINNET_TREASURY_ADDRESS>
# USDC ASA ID — Mainnet: 31566704 (Circle USDC)
X402_USDC_ASSET_ID=31566704

# ── Gora Oracle ─────────────────────────────────────────────────
# Mainnet App ID for the Gora Oracle consensus network
GORA_APP_ID=1275319623
GORA_REQUEST_FEE=100000
GORA_MAX_STALENESS_SECONDS=15
GORA_PRICE_FEED_KEY=USDC/ALGO

# ── Liquid Auth (FIDO2 / Passkey) ────────────────────────────────
# Relying Party ID — must match the domain serving the FIDO2 challenge
FIDO2_RP_ID=
# Relying Party Name — human-readable label shown in passkey prompts
FIDO2_RP_NAME=Algo AI Wallet
# Liquid Auth server URL for challenge/verify endpoints
LIQUID_AUTH_SERVER_URL=
# Expected origin for WebAuthn assertion validation
LIQUID_AUTH_EXPECTED_ORIGIN=

# ── Rocca Wallet (Seedless Signing) ─────────────────────────────
# Rocca API key for authenticated SDK calls
ROCCA_API_KEY=
# Rocca environment: "sandbox" | "production"
ROCCA_ENVIRONMENT=production
# Rocca webhook secret for signature confirmation callbacks
ROCCA_WEBHOOK_SECRET=

# ── Upstash Redis ───────────────────────────────────────────────
# Required for: replay guard, SuggestedParams cache (30s TTL),
# idempotent execute, rate limiting, API key index, telemetry.
# Create a free database at https://console.upstash.com
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# ── VibeKit Sandbox ─────────────────────────────────────────────
VIBEKIT_API_KEY=
# Sandbox execution timeout in ms (default: 30000)
VIBEKIT_TIMEOUT_MS=30000

# ── Portal Security ─────────────────────────────────────────────
# Secret used by the developer portal to authenticate /api/portal/* requests.
# Generate: openssl rand -hex 32
# Must match PORTAL_API_SECRET in the portal's .env.local
PORTAL_API_SECRET=

# ── Flywheel Treasury Refill (scripts/treasury-refill.ts) ────────
# Separate treasury wallet that funds the signing wallet until Rocca is live.
# Run:  tsx scripts/treasury-refill.ts
#
# ⚠️  REQUIRED for refill daemon:
ALGO_TREASURY_MNEMONIC=<25-word treasury wallet mnemonic>
#
# Target ALGO balance to maintain in the signing wallet (default: 10)
WALLET_TARGET_ALGO=10
# Minimum ALGO kept in the treasury after any refill (default: 2)
TREASURY_MIN_RESERVE_ALGO=2
# Fraction of target that triggers alert + auto-refill (default: 0.40 = 40%)
REFILL_ALERT_THRESHOLD=0.40
# How often to check the balance, in seconds (default: 60)
REFILL_CHECK_INTERVAL_S=60
# Slack / Discord / generic POST webhook URL for low-balance alerts (optional)
ALERT_WEBHOOK_URL=
